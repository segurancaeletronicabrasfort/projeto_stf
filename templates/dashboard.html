<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dashboard - Portal ABV</title>

    <link rel="manifest" href="/static/manifest.json">
    <meta name="theme-color" content="#072e4b">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="/static/assets/icon-192.png">
    
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <link rel="stylesheet" href="/static/style.css">
</head>
<body class="dashboard-body">

    <nav class="navbar">
        <div class="nav-brand">Portal de <strong>Solicitações</strong></div>
        <div class="nav-user">
            <span id="userDisplayName">Olá, Usuário</span>
            <button id="btnSettings" class="btn-logout" style="margin-right:5px;">
                <i class="fas fa-cog"></i> Config
            </button>
            <button id="btnLogout" class="btn-logout">
                <i class="fas fa-sign-out-alt"></i> Sair
            </button>
        </div>
    </nav>

    <div class="main-content">
        
        <section class="section-container glass-effect" data-aos="fade-up" data-aos-duration="800">
            <h3><i class="fas fa-clipboard-list"></i> Serviços Rápidos (Solicita Fácil)</h3>
            <p class="subtitle">Acesso direto aos formulários do PerformanceLab.</p>
            
            <div id="cardsContainer" class="cards-grid scroll-snap-mobile">
                
                <a href="https://pflab.top/CKV2SNVODI" target="_blank" class="card-action">
                    <div class="icon-box"><i class="fas fa-tools"></i></div>
                    <h4>Abertura de Chamado</h4>
                    <p>Manutenção predial e técnica.</p>
                </a>

                <a href="https://pflab.top/BOQJRITEWR" target="_blank" class="card-action">
                    <div class="icon-box"><i class="fas fa-user-shield"></i></div>
                    <h4>Segurança Eletrônica</h4>
                    <p>Solicitação de imagens e acessos.</p>
                </a>

                <a href="https://pflab.top/W7XZO8EPED" target="_blank" class="card-action">
                    <div class="icon-box"><i class="fas fa-laptop-medical"></i></div>
                    <h4>Suporte TI</h4>
                    <p>Problemas com hardware ou rede.</p>
                </a>
                
                <a href="https://pflab.top/BOQJRITEWR" target="_blank" class="card-action">
                    <div class="icon-box"><i class="fas fa-file-contract"></i></div>
                    <h4>Gestão de Contratos</h4>
                    <p>Acesso a documentos administrativos.</p>
                </a>

                <a href="#" class="card-action">
                    <div class="icon-box"><i class="fas fa-car"></i></div>
                    <h4>Frota</h4>
                    <p>Reserva de veículos.</p>
                </a>

                <a href="#" class="card-action">
                    <div class="icon-box"><i class="fas fa-users"></i></div>
                    <h4>RH Online</h4>
                    <p>Holerites e ponto.</p>
                </a>

            </div>

            <div id="expandContainer" style="text-align: center; margin-top: 20px; display: none;">
                <button id="btnExpandCards" class="btn-secondary" style="margin: 0 auto;">
                    <i class="fas fa-chevron-down"></i> Ver todos os serviços
                </button>
            </div>
        </section>

        <section id="biSection" class="section-container glass-effect" data-aos="fade-up" data-aos-delay="200">
            <div class="header-split">
                <h3><i class="fas fa-chart-line"></i> Indicadores de Gestão</h3>
                <button class="btn-secondary"><i class="fas fa-sync"></i> Atualizar Dados</button>
            </div>
            
            <div class="bi-container">
                <iframe 
                    title="Dashboad Monitoramento" 
                    width="100%" 
                    height="600" 
                    src="https://app.powerbi.com/view?r=eyJrIjoiYTNhOTM2MTItYWYwNi00MGQ5LTljOTktZjcyYjNlZDM5NWIyIiwidCI6IjY3ZDVkMzczLWE2YjAtNGE4Yi1iZDEzLTNhNWM3ZDdlY2ZhNyJ9" 
                    frameborder="0" 
                    allowFullScreen="true">
                </iframe>
            </div>
        </section>

    </div>

    <div id="settingsModal" class="modal-overlay" style="display: none;">
        <div class="modal-box">
            <div class="modal-header">
                <h3><i class="fas fa-cogs"></i> Gestão de Conta</h3>
                <span class="close-modal" onclick="closeModal('settingsModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 20px; text-align: center;">
                    <a href="admin_panel" class="btn-secondary" style="display: block; text-decoration: none; padding: 10px; background: #1e293b; color: white;">
                        <i class="fas fa-users-cog"></i> Acessar Painel de Controle Completo
                    </a>
                </div>
                <div class="config-section">
                    <h4>Alterar Minha Senha</h4>
                    <form id="changePasswordForm">
                        <div class="field">
                            <label>Senha Atual</label>
                            <input type="password" id="oldPass" required>
                        </div>
                        <div class="field">
                            <label>Nova Senha</label>
                            <input type="password" id="newPass" required>
                            <small class="password-hint">
                                A senha deve conter no mínimo 8 caracteres, incluindo pelo menos uma letra maiúscula, uma letra minúscula e um número.
                            </small>
                        </div>
                        <button type="submit" class="btn-save" style="width: 100%; margin-top: 10px;">Atualizar Senha</button>
                    </form>
                </div>
                <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">
            </div>
        </div>
    </div>

    <div id="appToast" class="app-toast">
        <div class="app-toast-icon"><i class="fas fa-check-circle"></i></div>
        <div class="app-toast-body">
            <strong id="appToastTitle">Sucesso</strong>
            <span id="appToastMessage">Mensagem</span>
        </div>
        <button id="appToastClose" type="button" class="app-toast-close">&times;</button>
    </div>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/static/sw.js')
                    .then(reg => console.log('PWA registrado!', reg.scope))
                    .catch(err => console.log('Falha no PWA:', err));
            });
        }
    </script>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({ once: true, offset: 50 }); // Inicializa animação
    </script>
    <script src="/static/script.js"></script>
</body>
</html>